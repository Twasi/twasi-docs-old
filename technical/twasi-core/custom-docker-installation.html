
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Custom Docker Installation Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-flexible-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="custom-installations.html" />
    
    
    <link rel="prev" href="plugin-series/" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                
<img src="/assets/twasi_logo.svg" alt="twasi" style="height:60px" />
<h2 style="margin: 10px;">Official Documentation</h2>

    <ul class="summary">
      
      
      
      
      
       
<li class="chapter " data-level="1.1" data-path="../../">
  
  <a href="../../">
    
        
        Introduction
        
      </a>
      
      
    </li>
    
<li class="chapter " data-level="1.2" data-path="../">
  
  <a href="../">
    
        
        Technical
        
      </a>
      
      
      <ul class="articles">
         
<li class="chapter " data-level="1.2.1" data-path="./">
  
  <a href="./">
    
        
        Twasi Core
        
      </a>
      
      
      <ul class="articles">
         
<li class="chapter " data-level="1.2.1.1" data-path="plugin-series/">
  
  <a href="plugin-series/">
    
        
        Plugin Series
        
      </a>
      
      
    </li>
    
<li class="chapter active" data-level="1.2.1.2" data-path="custom-docker-installation.html">
  
  <a href="custom-docker-installation.html">
    
        
        Custom Docker Installation
        
      </a>
      
      
    </li>
    
<li class="chapter " data-level="1.2.1.3" data-path="custom-installations.html">
  
  <a href="custom-installations.html">
    
        
        Custom Installations
        
      </a>
      
      
    </li>
    
    
      </ul>
      
    </li>
    
<li class="chapter " data-level="1.2.2" data-path="../twitch-web-api/">
  
  <a href="../twitch-web-api/">
    
        
        Twitch Web Api
        
      </a>
      
      
      <ul class="articles">
         
<li class="chapter " data-level="1.2.2.1" data-path="../twitch-web-api/initialization.html">
  
  <a href="../twitch-web-api/initialization.html">
    
        
        Initialization
        
      </a>
      
      
    </li>
    
    
      </ul>
      
    </li>
    
    
      </ul>
      
    </li>
    
<li class="chapter " data-level="1.3" data-path="../../user-docs/">
  
  <a href="../../user-docs/">
    
        
        User Docs
        
      </a>
      
      
      <ul class="articles">
         
<li class="chapter " data-level="1.3.1" data-path="../../user-docs/plugins/">
  
  <a href="../../user-docs/plugins/">
    
        
        Plugins
        
      </a>
      
      
      <ul class="articles">
         
<li class="chapter " data-level="1.3.1.1" data-path="../../user-docs/plugins/songrequest.html">
  
  <a href="../../user-docs/plugins/songrequest.html">
    
        
        Songrequest
        
      </a>
      
      
    </li>
    
    
      </ul>
      
    </li>
    
    
      </ul>
      
    </li>
    
    
      
      <li class="divider"></li>
    </ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Custom Docker Installation</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="install-twasi-core-using-docker">Install Twasi-Core using Docker</h1>
<p>Using docker is the easiest way to install Twasi-Core. It will run on all systems.</p>
<p>First, install docker on your system. You can find a tutorial about this <a href="https://docs.docker.com/engine/installation" target="_blank">here</a>.</p>
<p>Next, you need to start an instance of MongoDB. We recommend to have the volume on the host system (this makes it easier for upgrades).</p>
<pre><code>sudo docker run -d -p 27017:27017 -v /home/twasi/beta/db:/data/db mongo mongod
</code></pre><p>This command downloads and runs MongoDB. It mapps the hostport 27017 to the guest port 27017 and the guest directory (volume) /data/db to the host directory /home/twasi/beta/db. -d signals to detach (run in background).</p>
<p>After that, your MongoDB Server should run and be accessible on port 27017 of the host.</p>
<p>Next we need to enable authentication. For this, install mongodb-clients first:</p>
<pre><code>sudo apt-get install mongodb-clients
</code></pre><p>Then we are able to connect to our database:</p>
<pre><code>mongo localhost/admin
</code></pre><p>Admin is a default mongodb database in which the global users are stored. We need to create an admin user now.</p>
<pre><code class="lang-javascript">db.createUser({user: <span class="hljs-string">&quot;root&quot;</span>, pwd: <span class="hljs-string">&quot;s3cur3p4ssw0rd&quot;</span>, roles:[<span class="hljs-string">&quot;root&quot;</span>]})
</code></pre>
<p>This creates a root user with the roles root - please select a secure password!</p>
<p>Now we need to stop our container. Issue</p>
<pre><code>sudo docker ps
</code></pre><p>and grab the container id of the container with the &quot;mongo&quot; image.</p>
<p>Stop it using</p>
<pre><code>sudo docker stop [container id]
</code></pre><p>and remove it (it&apos;ll be recreated) using</p>
<pre><code>sudo docker container rm [container id]
</code></pre><p>Now lets create another mongo-container with authentication enabled:</p>
<pre><code>sudo docker run -d -p 27017:27017 -v /home/twasi/beta/db:/data/db mongo mongod --auth
</code></pre><p>This instance will share the volume with the first one, and therefore it will have our root user created. Now we can connect to the database and create an user for twasi (we need to authenticate from here on, just use the password created before):</p>
<pre><code>mongo -u root -p [passwordCreatedBefore] localhost/admin
</code></pre><p>We are now able to create an user with readWrite permissions on twasidb:</p>
<pre><code class="lang-javascript">db.createUser({user: <span class="hljs-string">&quot;twasi&quot;</span>, pwd: <span class="hljs-string">&quot;anothers3cur3p4ssw0rd&quot;</span>, roles:[<span class="hljs-string">&quot;readWrite&quot;</span>]})
</code></pre>
<p>exit with CTRL + C. Now the database is ready. Let&apos;s continue with starting twasi-core:</p>
<pre><code>sudo docker run -p 8010:8000 -v /home/twasi/beta/twasi-core:/data twasi/twasi-core
</code></pre><p>We will:</p>
<ul>
<li>Map the host port 8010 to the container port 8000 (API).</li>
<li>Map the host volume /home/twasi/beta/twasi-core to the container volume /data (You will install plugins there and manage your plugin.yml)</li>
</ul>
<p>You should see the same input as when you start your .jar the first time. It will fail because there is no database connection - but a config file is created anyways. Stop the application using CTRL + C (it will time out after 30 seconds anyways). Now a config file should be created in the volume (under /home/twasi/beta/twasi-core/twasi.yml). Edit the database information. TODO: Config file documentation.</p>
<p>After setting up the config file, run twasi-core in deamon mode:</p>
<pre><code>sudo docker run -d -p 8010:8000 -v /home/twasi/beta/twasi-core:/data twasi/twasi-core
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="plugin-series/" class="navigation navigation-prev " aria-label="Previous page: Plugin Series">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="custom-installations.html" class="navigation navigation-next " aria-label="Next page: Custom Installations">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Custom Docker Installation","level":"1.2.1.2","depth":3,"next":{"title":"Custom Installations","level":"1.2.1.3","depth":3,"path":"technical/twasi-core/custom-installations.md","ref":"technical/twasi-core/custom-installations.md","articles":[]},"previous":{"title":"Plugin Series","level":"1.2.1.1","depth":3,"path":"technical/twasi-core/plugin-series/README.md","ref":"technical/twasi-core/plugin-series/README.md","articles":[]},"dir":"ltr"},"config":{"plugins":["sharing","collapsible-chapters","page-toc","flexible-alerts"],"ignores":["node_modules"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"search":{},"collapsible-chapters":{},"page-toc":{"position":"before-first","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4","showByDefault":true},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"flexible-alerts":{"danger":{"className":"danger","icon":"fa fa-ban","label":"Attention"},"note":{"className":"info","icon":"fa fa-info-circle","label":"Note"},"style":"callout","tip":{"className":"tip","icon":"fa fa-lightbulb-o","label":"Tip"},"warning":{"className":"warning","icon":"fa fa-exclamation-triangle","label":"Warning"}},"sharing":{"all":["facebook","google","twitter","weibo","instapaper"],"facebook":true,"google":false,"instapaper":false,"twitter":true,"vk":false,"weibo":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"technical/twasi-core/custom-docker-installation.md","mtime":"2019-03-15T16:18:34.318Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-03-15T16:19:39.916Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-flexible-alerts/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

